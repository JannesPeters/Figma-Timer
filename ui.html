<!-- <h2>Figma Timer</h2> -->
<!-- <p>Seconds: <input id="seconds" value="5"></p> -->
<html>
<style>
body {
  font: 10px sans-serif;
  text-align: center;
  margin: 10px;
}
button {
  border-radius: 5px;
  background: white;
  color: black;
  border: none;
  padding: 8px 12px;
  margin: 0 2px;
  box-shadow: inset 0 0 0 1px black;
  outline: none;
}

button:active {
  background: lightgray;
}
</style>

<button id="start" style="width: 70;">Start</button>
<button id="reset">Reset</button>
<button id="help">?</button>
<b id="helptext" hidden> <br /> <br /> Type the time you want to count down in "Timer: HH:MM:SS" format in any text field (e.g. Timer: 5:00) then press 'start' </b>

<!-- <br /> <br /> <b id="timers" text-align=left;> </b> -->
</html>
<script>

document.getElementById('start').onclick = () => {
  const textbox = document.getElementById('seconds');
  //const count = parseInt(textbox.value, 10);
  const count = 0; // placeholder variable for changing time from UI
  var currentButtonState = document.getElementById('start').textContent;
  var helptextvisible = 0;


  switch (currentButtonState) {

    case 'Start': 
      parent.postMessage({ pluginMessage: { type: 'start', count } }, '*');
      document.getElementById('start').textContent = 'Pause';
      break;
  
    case 'Pause': 
      parent.postMessage({ pluginMessage: { type: 'pause', count } }, '*');
      document.getElementById('start').textContent = 'Continue';
      break;

    case 'Continue': 
      parent.postMessage({ pluginMessage: { type: 'continue', count } }, '*');
      document.getElementById('start').textContent = 'Pause';
      break;

    default: 
      //console.log('something went wrong');
  }
}


document.getElementById('reset').onclick = () => {
  parent.postMessage({ pluginMessage: { type: 'reset' } }, '*')
  document.getElementById('start').textContent = 'Start';
}

document.getElementById('help').onclick = () => {
  if (document.getElementById('helptext').hidden == true)
  {
    document.getElementById('helptext').hidden = false;
    parent.postMessage({ pluginMessage: { type: 'helpon' } }, '*')
  } else {
    document.getElementById('helptext').hidden = true;
    parent.postMessage({ pluginMessage: { type: 'helpoff' } }, '*')
  }
}

onmessage = (event) => {


  // I started some code here to show timers also in the UI window. This way the user can see timer, even if they are in a different place on the Figma canvas
  
  /**
  if (event.data.pluginMessage[0] == "start timer")
  {
    console.log("starting timer in UI")
    var timerText = document.createElement('div');
    
    timers.appendChild(timerText);
    timerText.id = event.data.pluginMessage[2];
    //document.getElementById(event.data.pluginMessage[2]).textContent = "success";
  }

  if (event.data.pluginMessage[0] == "end timer")
  {
    console.log("ending timer in UI")
    var myElement = document.getElementById(event.data.pluginMessage[2]);
    myElement.parentNode.removeChild(myElement);
  }

  if (event.data.pluginMessage[0] == "counting")
  {
    //console.log("counting inside UI" + event.data.pluginMessage[1])
    document.getElementById(event.data.pluginMessage[2]).textContent = event.data.pluginMessage[1];
  }
  */
}
</script>
